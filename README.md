# MiniB Compiler

[![Java](https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white)](https://www.java.com/es/)
[![ANTLR](https://img.shields.io/badge/ANTLR-4-red?style=for-the-badge)](https://www.antlr.org/)
[![Jasmin](https://img.shields.io/badge/Jasmin-Assembler-blue?style=for-the-badge)](http://jasmin.sourceforge.net/)

A full-featured compiler for **MiniB**, a custom imperative language inspired by **BASIC**, capable of generating executable JVM bytecode via **Jasmin assembler**.

## ðŸ“– About The Project

This project implements a complete compilation pipeline, translating MiniB source code into intermediate Jasmin assembly code, which is then assembled into Java `.class` files. The compiler is built using **Java** and **ANTLR 4**, focusing on robust lexical, syntactic, and semantic analysis.

Key architectural highlights include:
* **Visitor Pattern:** Used for traversing the Abstract Syntax Tree (AST) generated by ANTLR.
* **Symbol Table:** Dynamic management of variables, function contexts, and scope using HashMaps.
* **Semantic Analysis:** Compile-time type checking (strong typing for INT, FLOAT, STRING) and scope validation.
* **Code Generation:** Direct translation to stack-based JVM instructions.

## âœ¨ Key Features

The compiler supports a rich set of features, extending beyond basic instructions:

### Data Types & Operations
- **Primitive Types:** Support for `INT`, `STRING`, and `FLOAT`.
- **Implicit Conversion:** Automatic `INT` to `FLOAT` promotion during arithmetic operations.
- **String Manipulation:** Optimized concatenation using `StringBuilder`.
- **Dynamic Arrays:** Resizable arrays with `.ADD()` and index access methods.

### Control Structures
- **Conditionals:** `IF`, `THEN`, `ELSE`, `END` blocks.
- **Loops:**
  - `WHILE` loops.
  - `FOR` loops with custom `STEP` (positive and negative).
  - `REPEAT-UNTIL` structures.
  - Support for `EXIT` and `CONTINUE` statements.

### Functions
- **Function Definition:** Declare functions using `FUNC` with parameters.
- **Return Values:** Support for the `RETURN` statement.
- **Context Management:** Recursive calls and local scope isolation.

### Input / Output
- **Console I/O:** `PRINT` for output and `INPUT` for reading user data via `Scanner`.

## ðŸ› ï¸ Tech Stack

* **Language:** Java (JDK 11+)
* **Parser Generator:** ANTLR 4
* **Assembler:** Jasmin (to convert `.j` files to `.class`)
* **Build System:** Maven / Gradle (depending on your setup)

## ðŸ’» Code Examples

### 1. Greatest Common Divisor (GCD)
An example of `WHILE` loops and input handling:

```basic
REM Greatest common divisor
INPUT "A=" ain
INPUT "B=" bin
LET a = VAL(ain)
LET b = VAL(bin)

WHILE b > 0
    LET t = a MOD b
    LET a = b
    LET b = t
END

PRINT "GCD=" + a
```

### 2. Functions and Floats
Demonstrating function calls and floating-point arithmetic:

```basic
FUNC suma(a, b)
    RETURN a + b
END

LET cost = 150.75
LET tax = 0.18
LET total = suma(cost, cost * tax)

PRINT "Total Cost: " + total
```

### 3. Dynamic Arrays
Using the custom array implementation:

```basic
ARRAY myArray
myArray.ADD(10)
myArray.ADD(20)
myArray[0] = 99
PRINT myArray[0]
```

## ðŸš€ How to Run

### Prerequisites
Ensure you have the `antlr-4.13.2-complete.jar` and `jasmin.jar` in your root folder.

### 1. Generate ANTLR Sources
First, generate the Lexer and Parser Java files from the grammar.
```bash
java -jar antlr-4.13.2-complete.jar GMiniBLexer.g4 GMiniBParser.g4 -visitor -no-listener
```

### 2. Compile the Compiler

Compile all Java files (including the generated ones).

Linux/Mac:

```Bash
javac -cp .:antlr-4.13.2-complete.jar *.java
```

Windows (PowerShell):

```PowerShell
javac -cp ".;antlr-4.13.2-complete.jar" *.java
```

### 3. Run the Compiler

Pass your .bas file to generate the Jasmin assembly (.j) file.

Linux/Mac:

```Bash
java -cp .:antlr-4.13.2-complete.jar Main examples/input_script.bas
```

Windows (PowerShell):

```PowerShell
java -cp ".;antlr-4.13.2-complete.jar" Main examples/input_script.bas
```

### 4. Assemble with Jasmin

Convert the intermediate code (.j) to a Java class file (.class).

```Bash
java -jar jasmin.jar output.j
```

### 5. Execute

Run the resulting program on the JVM.

```Bash
java OutputClass
```
